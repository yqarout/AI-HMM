Copyright 2019 Yazan Qarout \
If you use this code in your research, please cite: \
Qarout, Y.; Raykov, Y.P.; Little, M.A. Probabilistic Modelling for Unsupervised Analysis of Human Behaviour in Smart Cities. Sensors 2020, 20, 784. 

# Adaptive Input infinite Hidden Markov Model (AI-HMM)
Implementation of the novel Adaptive Input infinite Hidden Markov Model (AI-HMM), a Bayesian nonparametric hidden Markov model which can leverage discrete contextual variables. Conventional HMMs are good at discovering interpretative time series clusters, AI-HMMs allow for HMMs to leverage additional discrete inputs, such as time of day and learn different transition dynamics for each additional category of context.

The AI-HMM is a flexible latent space model that to account for various types of contextual information. This contextual information can include difference between time series deicrepencies (for example data generated by different sensors), weekday/weekend differences in traffic behaviour and different enviornments of data collection. A probabilstic graphical model of the AI-HMM can be seen below.

![aihmm](https://user-images.githubusercontent.com/67744584/86615324-37d1d500-bfac-11ea-8497-60f3ecec6b11.png)

# Modeling Examples - Synthetic Data

Below is an image demonstrating the the performance of the AI-HMM at estimating the transition matrix on synthetic data. Given data generated from 2 different transition matrices (Π<sub>1</sub> and Π<sub>2</sub> actual), the model is capable of reproducing the transitions matrices (Π<sub>1</sub> and Π<sub>2</sub> estimated) with high accuracy.

<img width="671" alt="Screen Shot 2020-07-06 at 17 41 25" src="https://user-images.githubusercontent.com/67744584/86618285-8c774f00-bfb0-11ea-9217-299cb57af781.png">

To compare, the conventional HDP-AR-HMM can only reproduce a single transition matrix (Π<sub>HDP-AR-HMM</sub>)

<img width="329" alt="Screen Shot 2020-07-06 at 17 41 58" src="https://user-images.githubusercontent.com/67744584/86618820-74ec9600-bfb1-11ea-90e7-c4b5284313cf.png">

